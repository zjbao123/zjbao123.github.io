---
title: 一条SQL查询是如何执行的
date: 2018-12-04 20:35:00
tags: 
- MySQL
categories: 总结
---

![MySQL逻辑](一条SQL查询是如何执行的/MySQL逻辑.png)
MySQL大体可分为 Server层 和 存储引擎层两部分。
Server层包括连接器、查询缓存、分析器、优化器、执行器等，涵盖MySQL的大多数核心服务功能以及所有内置函数（如日期、时间、数学和加密函数等），所有跨存储引擎的功能都在这一层实现，比如存储过程，触发器，试图等。

<!-- more -->

而存储引擎层负责数据的存储和提取。其架构模式是插件式的。支持InnoDB，MyISAM、Memory等多个存储引擎，而InnoDB是最常用的，也成为了默认存储引擎。可以使用`engine=memory`来指定引擎。

从图中，不同的存储引擎共用一个Server层，也就是从连接器到执行器的部分。

### 连接器
连接器负责跟客户端建立连接，获取权限，维持和管理连接。
连接指令一般这样写:

```
mysql -h$ip -P$port -u$user -p
```

一般连接生产环境,建议输完命令后输入密码,直接输入容易导致密码泄露。

在用户名密码验证通过之后，连接器会到权限表里查出你拥有的权限。之后的权限，都依赖与此。也就意味着，在建立成功之后，即使你做了权限的修改，也要再新建连接才会使用新的权限设置。

连接完成之后，如果没有后续动作，这个连接就处于空闲状态，可以在`show processlist`中看到他。


